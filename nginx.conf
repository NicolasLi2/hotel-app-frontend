upstream frontend_server {
  server 127.0.0.1:5000;
}

upstream backend_server {
  server 127.0.0.1:8000;
}

server {
	listen 80;
	listen [::]:80;

	listen 443 ssl;
	listen [::]:443 ssl;

	#
	# Note: You should disable gzip for SSL traffic.
	# See: https://bugs.debian.org/773332
	#
	# Read up on ssl_ciphers to ensure a secure configuration.
	# See: https://bugs.debian.org/765782
	#
	# Self signed certs generated by the ssl-cert package
	# Don't use them in a production server!
	#
	# include snippets/snakeoil.conf;
	ssl_certificate /etc/ssl/linze_me_chain.crt;
	ssl_certificate_key /etc/ssl/server.key;

	root /usr/share/nginx/html;

	index index.html index.htm index.nginx-debian.html;

	server_name linze.me www.linze.me;
	return 301 https://$server_name$request_uri;

	# location / {
	# 	# proxy_pass http://127.0.0.1:3000/;
	# 	# First attempt to serve request as file, then
	# 	# as directory, then fall back to displaying a 404.
	# 	try_files $uri $uri/ =404;
	# }

  location / {
      proxy_pass http://frontend_server;
  }
  
  location /api {
      proxy_pass http://backend_server;
  }
}
